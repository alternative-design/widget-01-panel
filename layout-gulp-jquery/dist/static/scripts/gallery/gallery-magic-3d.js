"use strict";!function(){var t={};(function(){this.elem=document.getElementById("screen"),this.width=0,this.height=0,this.resize=function(){this.width=+this.elem.offsetWidth,this.height=+this.elem.offsetHeight},this.elem.onselectstart=function(){return!1},this.elem.ondragstart=function(){return!1},window.addEventListener("resize",this.resize.bind(this),!1),this.resize(),this.pointer={x:0,y:0,dx:0,dy:0,touchMode:!1,center:function(t){this.dx*=t,this.dy*=t,s=a=0}};var t=!1,e=0,i=0,s=0,a=0;this.addEvent=function(t,e){for(var i=0,s=t.split(",");i<s.length;i++)this.elem.addEventListener(s[i],e.bind(this.pointer),!1)},this.addEvent("mousemove,touchmove",function(h){h.preventDefault(),this.touchMode=h.targetTouches;var n=this.touchMode?this.touchMode[0]:h;this.x=n.clientX,this.y=n.clientY,t&&(this.dx=s-(this.x-e),this.dy=a-(this.y-i))}),this.addEvent("mousedown,touchstart",function(s){s.preventDefault(),this.touchMode=s.targetTouches;var a=this.touchMode?this.touchMode[0]:s;e=this.x=a.clientX,i=this.y=a.clientY,t=!0,setTimeout(function(){!t&&Math.abs(e-this.x)<11&&Math.abs(i-this.y)<11&&this.tap&&this.tap(s)}.bind(this),200)}),this.addEvent("mouseup,touchend,touchcancel",function(e){e.preventDefault(),s=this.dx,a=this.dy,t=!1})}).apply(t);var e=t.pointer,i=void 0!==document.body.style.webkitTransform?"-webkit-transform":"transform",s={};(function(){var t=[],e={normalPI:function(){Math.abs(this.target-this.value)>Math.PI&&(this.target<this.value?this.value-=2*Math.PI:this.value+=2*Math.PI)},setTarget:function(t,e){this.speedMod=e||1,this.target=t,this.isAngle&&(this.target=this.target%(2*Math.PI),this.normalPI()),this.running&&this.oldTarget===t||(this.oldTarget=t,this.running=!0,this.prog=0,this.from=this.value,this.dist=.5*-(this.target-this.from))},ease:function(){if(this.running){var t=this.speedMod*this.steps;this.prog++<t?(this.value=this.dist*(Math.cos(Math.PI*(this.prog/t))-1)+this.from,this.isAngle&&this.normalPI()):(this.running=!1,this.value=this.target)}}};this.add=function(i,s,a,h){var n=Object.create(e);return n.target=a||0,n.value=s||0,n.steps=i,n.isAngle=h||!1,n.speedMod=1,n.setTarget(n.target),t.push(n),n},this.iterate=function(){for(var e=0,i=t.length;e<i;e++)t[e].ease()}}).apply(s);for(var a=document.getElementById("cube"),h=document.querySelectorAll(".face"),n=0,r=h.length;n<r;n++){var o=h[n];o.style[i]=o.getAttribute("data-transform")}e.tap=function(t){if(t.target.className.indexOf("face")>=0){var e=""==t.target.alt?t.target:document.getElementById(t.target.alt);d.setTarget(e)}};var d={globalRX:0,globalRY:0,z:s.add(100,0,0),rx:s.add(100,0,0,!0),ry:s.add(100,0,0,!0),targeted:null,setTarget:function(t){var e,i=((e=getComputedStyle(t,null)).transform||e.webkitTransform).split(/\s*[(),]\s*/).slice(1,-1),s=Math.asin(-i[2]),a=Math.atan2(+i[6],+i[10]);if(s&&(s-=Math.PI),a&&(a-=Math.PI),this.targeted&&(this.targeted.style.outline="rgba(0,0,0,1) solid 10px"),this.targeted!=t)this.z.setTarget(600),"4"==t.id&&(document.getElementById("7").style.visibility="hidden"),"7"==t.id&&(this.z.setTarget(-200),document.getElementById("7").style.visibility="visible"),t.style.outline="rgba(255,255,255,1) solid 10px",this.targeted=t;else{if(this.z.setTarget(0),"7"==t.id)return void d.setTarget(document.getElementById("1"));this.targeted=null}this.rx.setTarget(a),this.ry.setTarget(s)},move:function(){if(s.iterate(),e.touchMode){var h=.001*-e.dy,n=.001*e.dx;e.center(.98)}else h=.001*-(e.y-.5*t.height),n=.001*+(e.x-.5*t.width);this.globalRX+=.1*(h-this.globalRX),this.globalRY+=.1*(n-this.globalRY),a.style[i]="translateZ("+this.z.value+"px) rotateX("+(this.rx.value+this.globalRX)+"rad) rotateY("+(this.ry.value+this.globalRY)+"rad)"}};!function t(){requestAnimationFrame(t),d.move()}()}();